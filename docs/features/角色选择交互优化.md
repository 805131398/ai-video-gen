# 角色选择交互优化

## 更新时间
2026-01-28

## 更新内容

将角色选择方式从下拉列表改为卡片多选模式，提升用户体验。

## 主要改动

### 1. 交互方式变更

**之前：**
- 使用下拉列表选择单个角色
- 选择后立即显示"编辑剧本"按钮

**现在：**
- 点击"选择角色"按钮进入选择模式
- 在角色卡片上直接点击进行多选
- 选中的卡片显示蓝色边框和勾选标记
- 只有选中角色后才显示"编辑剧本"按钮

### 2. 视觉反馈

**选中状态：**
- 蓝色边框（border-blue-500）
- 阴影效果（shadow-lg）
- 蓝色光晕（ring-2 ring-blue-200）
- 右上角勾选标记（蓝色圆形背景 + 白色勾号）

**未选中状态：**
- 灰色边框（border-slate-200）
- 右上角灰色圆形标记

### 3. 模式切换

**选择模式：**
- 隐藏角色卡片的编辑/删除按钮
- 卡片变为可点击状态
- 显示"取消选择"和"编辑剧本 (N)"按钮

**正常模式：**
- 显示角色卡片的编辑/删除按钮
- 显示"选择角色"和"添加角色"按钮

## 修改文件

### 前端组件
- `client/src/components/project/CharacterCard.tsx`
  - 添加 `isSelectMode`、`isSelected`、`onToggleSelect` props
  - 添加选中状态样式
  - 在选择模式下隐藏操作按钮
  - 添加右上角勾选标记

### 页面逻辑
- `client/src/pages/ProjectDetail.tsx`
  - 添加 `isSelectMode` 状态（是否处于选择模式）
  - 添加 `selectedCharacterIds` 状态（选中的角色 ID 集合）
  - 添加 `handleToggleSelectMode` 方法（切换选择模式）
  - 添加 `handleToggleCharacterSelection` 方法（切换角色选中状态）
  - 修改 `handleCreateScriptsForSelectedCharacters` 方法（为选中角色创建剧本）
  - 更新按钮区域布局

## 用户体验提升

1. **更直观**：直接在卡片上点击选择，无需下拉列表
2. **支持多选**：可以同时选择多个角色（虽然目前只为第一个创建剧本）
3. **视觉反馈清晰**：选中状态一目了然
4. **避免误操作**：选择模式下隐藏编辑/删除按钮
5. **灵活性**：可以随时取消选择模式

## 后续优化方向

1. **批量创建剧本**：为所有选中的角色创建剧本
2. **全选/反选**：添加全选和反选按钮
3. **选中数量提示**：在选择模式下显示"已选中 N 个角色"
4. **键盘快捷键**：支持 Shift/Ctrl 多选
5. **拖拽选择**：支持框选多个角色

## 测试要点

1. 点击"选择角色"按钮，验证进入选择模式
2. 点击角色卡片，验证选中状态切换
3. 验证选中卡片的视觉效果（边框、勾选标记）
4. 验证"编辑剧本"按钮只在选中角色后显示
5. 验证"编辑剧本"按钮显示选中数量
6. 点击"取消选择"，验证退出选择模式
7. 验证选择模式下隐藏编辑/删除按钮
8. 验证创建剧本并跳转功能
