# 前端添加故事板模式选项

**日期**: 2026-01-29
**类型**: 前端功能增强
**影响范围**: Client - 剧本编辑器

## 修改内容

### 文件
`client/src/pages/ScriptEditor.tsx`

### 新增功能

在剧本编辑器的"生成视频"按钮旁边添加了故事板模式选项，让用户可以选择使用哪种模式生成视频。

## UI 组件

### 1. 复选框
- 位置：生成视频按钮左侧
- 样式：浅灰色背景，带边框的容器
- 功能：切换故事板模式开关

### 2. 信息图标（Info Icon）
- 位置：复选框右侧
- 功能：鼠标悬浮显示详细说明
- 样式：深色背景的提示框，带箭头指示

### 3. 提示内容

**故事板模式：**
- 一次性生成包含所有场景的完整视频
- 场景之间转场更流畅，视频整体更连贯
- 适合场景数量少（≤5个）且总时长≤25秒的情况

**单独生成模式：**
- 为每个场景单独生成视频
- 可以独立调整每个场景，失败不影响其他场景
- 适合场景数量多或需要精细控制的情况

## 代码实现

### 状态管理
```typescript
const [useStoryboard, setUseStoryboard] = useState(false);
```

### API 调用
```typescript
const result = await generateScriptVideos(id!, scriptId, {
  promptType: 'smart_combine',
  mode: useStoryboard ? 'storyboard' : 'individual',
});
```

### 成功消息
```typescript
const modeText = useStoryboard ? '故事板模式' : '单独生成模式';
alert(`视频生成任务已提交！\n模式: ${modeText}\n...`);
```

## 视觉效果

```
┌─────────────────────────────────────────────────────────┐
│  取消  │ ☑ 故事板模式 ⓘ │ 🎬 生成视频 │ 💾 保存 │
└─────────────────────────────────────────────────────────┘
           ↑                ↑
           复选框          悬浮提示
```

鼠标悬浮在 ⓘ 图标上时，显示深色提示框：

```
┌──────────────────────────────────────┐
│ ✓ 故事板模式：                        │
│   一次性生成包含所有场景的完整视频...  │
│                                      │
│ ✓ 单独生成模式：                      │
│   为每个场景单独生成视频...           │
└──────────────────────────────────────┘
              ▼
```

## 用户体验

### 默认行为
- 默认不勾选（单独生成模式）
- 保持向后兼容

### 交互流程
1. 用户勾选"故事板模式"复选框
2. 鼠标悬浮在 ⓘ 图标上查看说明
3. 点击"生成视频"按钮
4. 显示成功消息，包含选择的模式
5. 返回剧本列表页查看进度

### 提示信息
- 成功消息中显示选择的模式
- 帮助用户确认使用的是哪种模式

## 样式特点

### 复选框容器
- 背景：`bg-slate-50`
- 边框：`border-slate-200`
- 内边距：`px-3 py-2`
- 圆角：`rounded-lg`

### 信息提示框
- 背景：`bg-slate-900`（深色）
- 文字：白色
- 宽度：`w-72`（固定宽度）
- 阴影：`shadow-lg`
- 动画：淡入淡出效果
- 箭头：底部中间位置

### 颜色区分
- 故事板模式：紫色高亮（`text-purple-300`）
- 单独生成模式：蓝色高亮（`text-blue-300`）

## 响应式设计

- 提示框固定宽度，确保内容完整显示
- 使用 `group` 和 `group-hover` 实现悬浮效果
- 提示框位置：底部上方，右对齐
- z-index: 50，确保在其他元素之上

## 测试建议

1. **功能测试**:
   - 勾选/取消勾选复选框
   - 验证 API 调用参数正确
   - 验证成功消息显示正确

2. **UI 测试**:
   - 鼠标悬浮显示提示框
   - 提示框位置和样式正确
   - 响应式布局正常

3. **交互测试**:
   - 复选框状态保持
   - 提示框淡入淡出动画
   - 不同模式的生成结果

## 总结

本次修改为前端添加了故事板模式选项：

- ✅ 添加复选框让用户选择模式
- ✅ 添加信息图标和悬浮提示
- ✅ 详细说明两种模式的区别
- ✅ 成功消息显示选择的模式
- ✅ 美观的 UI 设计
- ✅ 流畅的交互体验

用户现在可以在前端界面中轻松选择视频生成模式，并通过悬浮提示了解每种模式的特点和适用场景。
