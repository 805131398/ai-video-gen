# AI 生成脚本大概 - 通用引导话术 + 参考已输入内容

**日期**: 2026-01-28
**类型**: Feature Enhancement
**功能**: AI 生成脚本大概（Synopsis）

## 需求背景

短视频营销的核心是在内容结尾引导观众进行互动和转化。这不仅限于健康疾病类内容，而是适用于所有类型的短视频。

**用户需求**：
1. **通用的引导话术**：所有类型的内容都应该在结尾添加引导性话术
2. **智能适配内容类型**：话术要根据内容类型自然调整
3. **支持已输入内容**：用户可以先输入一部分内容，AI 基于此进行扩展

## 实施方案

### 需求 1：通用的引导话术

#### 核心逻辑

- **默认添加**：所有类型的内容都默认在结尾添加引导话术
- **智能适配**：话术根据内容类型自动调整
- **可选退出**：用户可以在项目主题或描述中明确说"不要引导话术"来禁用

#### 不同类型的引导话术示例

##### 1. 健康疾病类
```
"XX的病终于稳定下来了，如果有同样问题的朋友还有这种困扰的话可以找我咨询，只为帮助每一位朋友。"
```

##### 2. 产品评测类
```
"用了这个鼠标后技术变好了，如果你也想提升游戏水平可以找我交流，我会分享更多使用心得。"
"这款产品确实解决了我的问题，如果你也在纠结选什么，可以来找我聊聊，帮你少走弯路。"
```

##### 3. 美食探店类
```
"这家店的味道真的很棒，如果你也想知道更多好吃的地方可以找我推荐，我会持续分享。"
```

##### 4. 技能教学类
```
"通过这个方法我的摄影技术提升了很多，如果你也想学习可以找我交流，一起进步。"
```

##### 5. 生活经验类
```
"这个方法真的帮我解决了大问题，如果你也遇到类似的困扰，欢迎找我聊聊，希望能帮到你。"
```

##### 6. 旅游攻略类
```
"这次旅行的体验太棒了，如果你也想了解更多旅游攻略可以找我交流，我会分享更多实用信息。"
```

#### 话术结构

所有引导话术都遵循相同的结构：

1. **描述结果**：先描述问题得到解决或目标达成
   - "XX终于好了"
   - "技术提升了"
   - "找到了好方法"
   - "体验太棒了"

2. **表达态度**：表达愿意帮助他人的真诚态度
   - "如果你也..."
   - "欢迎找我..."
   - "希望能帮到你"

3. **使用温和词汇**：避免商业化表达
   - ✅ "咨询"、"交流"、"聊聊"、"推荐"
   - ❌ "购买"、"下单"、"联系客服"

### 需求 2：参考已输入内容

#### 核心逻辑

- 用户可以在"脚本大概"输入框中先输入一部分内容
- AI 生成时会读取这些已输入的内容
- 基于已有内容进行扩展、续写或完善
- 保持风格和内容的连贯性

#### 使用场景

##### 场景 1：用户输入开头，AI 续写

**用户输入**：
```
父亲因为长期劳累导致腰痛
```

**AI 生成**：
```
父亲因为长期劳累导致腰痛，去了很多医院都没有好转。后来经朋友
介绍，找到了一位老中医，通过推拿和膏药治疗，父亲的腰痛逐渐缓解，
现在已经能正常活动了。父亲的病终于稳定下来了，如果有同样问题的
朋友还有这种困扰的话可以找我咨询，只为帮助每一位朋友。
```

##### 场景 2：用户输入大纲，AI 扩展

**用户输入**：
```
测试了三款游戏鼠标，最后选择了这款
```

**AI 生成**：
```
测试了三款游戏鼠标，最后选择了这款。这款鼠标的握感特别舒适，
DPI 调节也很灵敏，用了一个月后，我的游戏胜率明显提升了。特别
是在 FPS 游戏中，精准度提高了很多。用了这个鼠标后技术变好了，
如果你也想提升游戏水平可以找我交流，我会分享更多使用心得。
```

##### 场景 3：用户输入完整内容，AI 润色

**用户输入**：
```
这家店在老街深处，老板娘的手艺很好，红烧肉特别好吃
```

**AI 生成**：
```
这家店隐藏在老街深处，老板娘的手艺传承了三代，每一道菜都充满了
家的味道。特别推荐他们家的红烧肉，肥而不腻，入口即化，那种独特
的香味让人回味无穷。这家店的味道真的很棒，如果你也想知道更多
好吃的地方可以找我推荐，我会持续分享。
```

## 技术实现

### 后端 API 修改

**文件**: `web/src/app/api/projects/[id]/scripts/generate-synopsis/route.ts`

#### 1. 接收 existingSynopsis 参数

```typescript
const { characterIds, tone, existingSynopsis } = body;
```

#### 2. 更新 System Prompt

```typescript
重要要求（结尾引导话术）：
- 必须在剧本大概的结尾添加引导性话术
- 引导话术要根据内容类型智能调整
- 引导话术的核心结构：
  1. 先描述问题得到解决或目标达成
  2. 表达愿意帮助他人的真诚态度
  3. 使用温和的词汇
  4. 避免过于商业化的表达

[提供多种类型的示例...]

特殊情况：
- 如果用户明确提到"不要引导话术"，则不添加
- 否则默认必须添加
```

#### 3. 更新 User Prompt

```typescript
${existingSynopsis ? `
用户已输入的内容：
${existingSynopsis}

请基于用户已输入的内容进行扩展、续写或完善，保持风格和内容的连贯性。
如果用户输入的内容已经比较完整，可以适当润色并确保添加结尾引导话术。
` : ""}
请生成剧本大概：
```

### 前端修改

#### 1. 更新 API 类型定义

**文件**: `client/src/services/script.ts`

```typescript
export const generateSynopsis = async (
  projectId: string,
  data: {
    characterIds: string[];
    tone?: string;
    existingSynopsis?: string; // 新增参数
  }
): Promise<{ synopsis: string }> => {
  const response = await api.post(`/projects/${projectId}/scripts/generate-synopsis`, data);
  return response.data;
};
```

#### 2. 更新调用逻辑

**文件**: `client/src/pages/ScriptEditor.tsx`

```typescript
const result = await generateSynopsis(id!, {
  characterIds: formData.characterIds,
  tone: formData.tone || undefined,
  existingSynopsis: formData.synopsis.trim() || undefined, // 传递已输入的内容
});
```

## 工作流程

### 流程 1：从零开始生成

```
用户操作：
1. 选择角色
2. 选择基调（可选）
3. 点击"AI 生成脚本大概"

AI 处理：
1. 根据项目主题、角色设定生成剧本大概
2. 根据内容类型智能添加引导话术
3. 返回完整的剧本大概

结果：
完整的剧本大概 + 引导话术
```

### 流程 2：基于已输入内容生成

```
用户操作：
1. 在"脚本大概"输入框中输入一部分内容
2. 选择角色
3. 点击"AI 生成脚本大概"

AI 处理：
1. 读取用户已输入的内容
2. 基于已有内容进行扩展或续写
3. 保持风格和内容的连贯性
4. 确保添加引导话术
5. 返回完整的剧本大概

结果：
扩展后的剧本大概 + 引导话术
```

### 流程 3：禁用引导话术

```
用户操作：
1. 在项目主题或描述中明确写"不要引导话术"
2. 选择角色
3. 点击"AI 生成脚本大概"

AI 处理：
1. 检测到用户明确要求不要引导话术
2. 生成剧本大概但不添加引导话术
3. 返回纯粹的剧本大概

结果：
剧本大概（无引导话术）
```

## 示例对比

### 示例 1：产品评测（鼠标）

**项目主题**: "游戏鼠标测评"

**生成的剧本大概**:
```
作为一个 FPS 游戏爱好者，我一直在寻找一款合适的游戏鼠标。
测试了市面上三款热门鼠标后，最终选择了这款。它的握感特别
舒适，DPI 调节灵敏，用了一个月后，我的游戏胜率明显提升了。
特别是在紧张的团战中，精准的定位让我能够快速击杀对手。用了
这个鼠标后技术变好了，如果你也想提升游戏水平可以找我交流，
我会分享更多使用心得。
```

### 示例 2：美食探店

**项目主题**: "老街美食探店"

**生成的剧本大概**:
```
今天带大家探访一家隐藏在老街深处的小吃店，老板娘的手艺传承了
三代，每一道菜都充满了家的味道。特别推荐他们家的红烧肉，肥而
不腻，入口即化，那种独特的香味让人回味无穷。店里的环境虽然简朴，
但那份真诚和用心让人感动。这家店的味道真的很棒，如果你也想知道
更多好吃的地方可以找我推荐，我会持续分享。
```

### 示例 3：技能教学

**项目主题**: "手机摄影技巧"

**生成的剧本大概**:
```
很多人觉得手机拍不出好照片，其实只是没掌握技巧。今天分享三个
简单但实用的手机摄影技巧：构图的三分法则、光线的运用、以及后期
的简单调色。通过这些方法，我的手机摄影水平提升了很多，朋友圈的
照片经常被点赞。通过这个方法我的摄影技术提升了很多，如果你也想
学习可以找我交流，一起进步。
```

### 示例 4：基于已输入内容

**用户输入**:
```
父亲因为长期劳累导致腰痛
```

**AI 生成**:
```
父亲因为长期劳累导致腰痛，去了很多医院都没有好转，吃了不少药
也只是暂时缓解。后来经朋友介绍，找到了一位老中医，通过推拿和
膏药治疗，配合日常的养生调理，父亲的腰痛逐渐缓解，现在已经能
正常活动了，甚至还能下地干活。父亲的病终于稳定下来了，如果有
同样问题的朋友还有这种困扰的话可以找我咨询，只为帮助每一位朋友。
```

## 修改的文件

### 后端
1. **修改**: `web/src/app/api/projects/[id]/scripts/generate-synopsis/route.ts`
   - 接收 `existingSynopsis` 参数
   - 更新 System Prompt（通用引导话术）
   - 更新 User Prompt（参考已输入内容）

### 前端
2. **修改**: `client/src/services/script.ts`
   - 更新 `generateSynopsis` 函数类型定义
   - 添加 `existingSynopsis` 参数

3. **修改**: `client/src/pages/ScriptEditor.tsx`
   - 调用 API 时传递 `existingSynopsis` 参数

### 文档
4. **新增**: `docs/features/AI生成脚本大概-通用引导话术+参考已输入内容-2026-01-28.md`

## 测试验证

### 测试用例 1：产品评测类

**输入**:
- 项目主题: "游戏鼠标测评"
- 角色: 数码博主
- 已输入内容: 无

**预期输出**:
- 完整的剧本大概
- 结尾包含产品评测类的引导话术
- 话术自然融入，提到"交流"、"分享使用心得"

### 测试用例 2：基于已输入内容

**输入**:
- 项目主题: "健康养生"
- 角色: 草根老中医
- 已输入内容: "父亲因为长期劳累导致腰痛"

**预期输出**:
- 基于已输入内容进行扩展
- 保持风格连贯
- 结尾包含健康疾病类的引导话术

### 测试用例 3：禁用引导话术

**输入**:
- 项目主题: "美食探店（不要引导话术）"
- 角色: 美食博主
- 已输入内容: 无

**预期输出**:
- 完整的剧本大概
- 不包含引导话术

## 用户体验提升

### 之前
- 只有健康疾病类内容有引导话术
- 其他类型需要用户手动添加
- 不支持基于已输入内容生成

### 现在
- 所有类型的内容都自动添加引导话术
- 话术根据内容类型智能调整
- 支持基于已输入内容进行扩展
- 用户可以选择禁用引导话术

## 总结

通过这次实施，实现了：

1. ✅ **通用引导话术**：所有类型的内容都默认添加引导话术
2. ✅ **智能适配**：话术根据内容类型自动调整
3. ✅ **多样化示例**：提供 6 种类型的话术示例
4. ✅ **参考已输入内容**：支持基于用户已输入的内容进行扩展
5. ✅ **可选退出**：用户可以明确要求不添加引导话术
6. ✅ **保持连贯性**：AI 会保持风格和内容的连贯性

这个功能大大提升了短视频营销的效率，帮助用户更好地实现内容转化。
